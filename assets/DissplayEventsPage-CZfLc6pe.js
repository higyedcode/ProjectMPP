import{u as p,j as e,r as s,P as A,E as I,L as x,g as c,a as D,I as P,d as L}from"./index-CFRkiK0b.js";function b({givenEvent:n,removeMethod:h}){const r=p(),a=()=>{r("/editEvent/"+n.eventId)};return e.jsxs("div",{className:"card","data-testid":"event-card",onClick:a,children:[e.jsx("button",{className:"remove-button","data-testid":"remove-button",onClick:d=>{d.stopPropagation(),h(n.eventId)},children:"X"}),e.jsx("div",{className:"card-info","data-testid":"card-info",children:e.jsxs("div",{className:"event-info",children:[e.jsx("div",{className:"event-id",hidden:!0,children:n.eventId}),e.jsx("div",{className:"name",children:n.eventName}),e.jsx("div",{className:"date",children:n.eventDate.toDateString()}),e.jsx("div",{className:"location",children:n.eventLocation})]})})]})}function y(){document.title="Events Dashboard!";const n=s.useContext(A),r=s.useContext(I).hostId;let[a,d]=s.useState(n.isAscending?"ASC":"DESC"),[m,l]=s.useState(!0),[v,C]=s.useState(!0),[E,S]=s.useState(0),[o,j]=s.useState(1),[g,i]=s.useState([]);if(localStorage.getItem("token")===null)return e.jsx(x,{entity:"Events",children:e.jsx("div",{className:"main-page-container",children:e.jsx("h1",{children:" Please log in to view events "})})});const N=t=>{L(t).then(()=>{console.log("DELETE "+t),c(o-1,a=="ASC").then(u=>{i(u),C(!v),l(!0)})})},f=()=>{console.log(r),console.log(o-1),c(o,a=="ASC").then(t=>{i([...g,...t]),(o+1)*15-E<15?(j(o+1),n.setCurrentPageId(o+1),l(!0)):l(!1)})};return s.useEffect(()=>{console.log("isAscending/updateFlag changed"),c(0,a=="ASC",o*15).then(t=>{i(t),l(!0)}),D().then(t=>{console.log("NR EVENTS "+t),S(t)})},[a,v]),s.useEffect(()=>{o=1,c(0,a=="ASC",15).then(t=>{i(t),console.log("LOADED "+t)}).catch(t=>{console.log("eroare"),console.log(t)})},[]),e.jsx(P,{dataLength:o*15,next:f,hasMore:m,loader:e.jsx("div",{className:"loading",children:e.jsx("p",{children:"Loading ..."})}),children:e.jsx(x,{entity:"Events",children:e.jsxs("div",{className:"main-page-container",children:[e.jsx("button",{className:"sort",onClick:()=>d(a==="ASC"?"DESC":"ASC"),children:a}),e.jsx("div",{className:"events-list","data-testid":"events-list",children:g.map((t,u)=>e.jsx(b,{givenEvent:t,removeMethod:N},u))})]})})})}export{y as default};
